---
# CLOUD MACHINE WITH MAIL AND WEB

#==============================
# Network and Firewall - Appropriate ports will be opened for named
# services (mail=submission and imaps, apache=http/https, etc).  SSH
# is always open.  Any extra ports go in the lists below.  Fail2ban
# also checks the services list to see what jails to use.
#
firewall_services: [ 'mail', 'web' ]
#firewall_opentcp: [any extra ports]
#firewall_openudp: [any extra ports]

# fail2ban will ignore these networks
# firewall_friendly_networks:


#==============================
# Encrypted Directories - Override the directories for various
# packages to keep the data in an encrypted partition at rest.
#
cryptdir_root: /vault

# Default is EncFS, use LUKS if we have a separate partition
#cryptdir_type: luks
#cryptdir_luks_dev: "/dev/replace-with-real-device"

# mailboot script generated by the cryptdir role
cryptdir_boot_script: /usr/sbin/mailboot
cryptdir_boot_services:
  - postfix
  - dovecot
  - redis-server
  - rspamd

# Keep mail spool, user database and keys in the encrypted directory.
# You can move the mail queue there if using luks, but not with encfs.
mail_spool_root:        "{{cryptdir_root}}/vmail"
mail_db_root:           "{{cryptdir_root}}/maildb"
mail_sieve_root:        "{{cryptdir_root}}/sieve"
mail_dkim_root:         "{{cryptdir_root}}/dkim"
# only if using luks
#mail_queue_dir:        "{{cryptdir_root}}/postfix"

# fcntl does not work with encfs, use dot locking instead
dovecot_use_dotlock: "{{ cryptdir_type|default('encfs') == 'encfs' }}"

# Web data usually left in the default /var/www, but you can move it
# under the encrypted root if you want to.  Add apache to the mailboot
# services above if you do.
#
#webdata_root:          "{{cryptdir_root}}/www"


#==============================
# Backup Directories - for mail and web server
#
bacula_default_client_fileset:
  include:
    - /etc/letsencrypt
    - "{{mail_db_root}}"
    - "{{mail_dkim_root}}"
    - "{{mail_spool_root}}"
    - "{{webdata_root}}"
  exclude: []



